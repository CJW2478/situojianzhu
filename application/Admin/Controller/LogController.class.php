<?php// +----------------------------------------------------------------------// | ThinkCMF 流程图文管理板块// +----------------------------------------------------------------------// | Copyright (c) 2013-2014 http://www.thinkcmf.com All rights reserved.// +----------------------------------------------------------------------// | Author: 业余爱好者 <649180397@qq.com>// +----------------------------------------------------------------------namespace Admin\Controller;use Common\Controller\AdminbaseController;use Common\Model\LogModel;class LogController extends AdminbaseController{    private $LogModel;    public function __construct()    {        parent::__construct();        $this->LogModel = new LogModel();    }    public function index()    {               $keyword=I('keyword','','trim');        $dotype=I('dotype','','trim');                $starttime =I('starttime','','trim');        $endtime =I('endtime','','trim');                if(!empty($keyword)){            $keyword=$keyword;            $keyword_complex=array();            $keyword_complex['u.mobile']  = array('like', "%$keyword%");            $keyword_complex['log.dotype']  = array('like',"%$keyword%");            $keyword_complex['log.remark']  = array('like',"%$keyword%");            $keyword_complex['_logic'] = 'or';            $where['_complex'] = $keyword_complex;        }        if(!empty($dotype)){            $where['log.dotype']=$dotype;        }                //  注册时间        if(!empty($starttime))        {            $where['log.create_time']=array(                array('EGT',strtotime($starttime))            );        }        if(!empty($endtime))        {            array_push($where['log.create_time'], array('ELT',strtotime($endtime.' 23:59:59')));        }        $count = $this->LogModel                ->alias('log')                ->join('left join xly_users u on log.adminid=u.id')                ->where($where)                ->count();        $page = $this->page($count, 20);        $list = $this->LogModel            ->alias('log')            ->field('log.*,u.user_name,u.mobile')            ->join('left join xly_users u on log.adminid=u.id')            ->where($where)            ->order('log.create_time desc')            ->limit($page->firstRow , $page->listRows)            ->select();               $this->assign("page", $page->show('Admin'));              $this->assign("formget",array_merge($_GET,$_POST));          $this->assign("list",$list);        $this->display();    }}